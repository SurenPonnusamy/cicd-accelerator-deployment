FROM alpine:latest 

ADD supervisor.conf /root/supervisor.conf

RUN apk add nodejs npm curl supervisor

ADD cicd-accelerator-frontend cicd-accelerator-frontend

ADD cicd-accelerator-backend cicd-accelerator-backend

WORKDIR cicd-accelerator-backend

RUN npm install

WORKDIR /

WORKDIR cicd-accelerator-frontend

RUN npm install

#RUN npm run build

#RUN npm install -g serve

WORKDIR /

EXPOSE 3001 3000

RUN mkdir -p /var/log/supervisor

CMD ["supervisord", "-c", "/root/supervisor.conf"]
